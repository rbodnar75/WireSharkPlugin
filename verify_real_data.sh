#!/bin/bash

echo "=== Verification: Real vs Sample Data Analysis ==="
echo ""

# Use the specific metasploit capture file we know works
CAPTURE_FILE="/Users/rbodnar/Downloads/metasploit-sip-invite-spoof.pcap"

if [ -z "$CAPTURE_FILE" ]; then
    echo "‚ùå No capture file found"
    exit 1
fi

echo "üìÅ Analyzing: $(basename "$CAPTURE_FILE")"
echo "üìä File size: $(ls -lh "$CAPTURE_FILE" | awk '{print $5}')"

# Show actual packet info
echo ""
echo "üîç First 5 packets from REAL capture:"
/Applications/Wireshark.app/Contents/MacOS/tshark -r "$CAPTURE_FILE" -T fields \
    -e frame.number -e ip.src -e ip.dst -e _ws.col.Protocol -e frame.len \
    -E header=n -E separator=, -E quote=d -E occurrence=f | head -5 | \
    awk -F',' '{printf "  Packet %s: %s ‚Üí %s (%s) %s bytes\n", $1, $2, $3, $4, $5}'

echo ""
echo "üìà Protocol distribution:"
/Applications/Wireshark.app/Contents/MacOS/tshark -r "$CAPTURE_FILE" -T fields \
    -e _ws.col.Protocol -E header=n | sort | uniq -c | sort -nr

echo ""
echo "‚úÖ This is REAL network traffic data from an actual capture file!"
echo "   Not synthetic/sample data generated by the plugin."
echo ""
